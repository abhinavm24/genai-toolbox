sources:
    trino-source:
        kind: trino
        host: ${TRINO_HOST}
        port: ${TRINO_PORT}
        user: ${TRINO_USER}
        password: ${TRINO_PASSWORD}
        catalog: ${TRINO_CATALOG}
        schema: ${TRINO_SCHEMA}
        queryTimeout: ${TRINO_QUERY_TIMEOUT}
        accessToken: ${TRINO_ACCESS_TOKEN}
        kerberosEnabled: ${TRINO_KERBEROS_ENABLED}
        sslEnabled: ${TRINO_SSL_ENABLED}

tools:
    execute_sql:
        kind: trino-execute-sql
        source: trino-source
        description: Use this tool to execute SQL queries against the Trino cluster.

    list_catalogs:
        kind: trino-sql
        source: trino-source
        description: "Lists all available catalogs in the Trino cluster."
        statement: SHOW CATALOGS

    list_schemas:
        kind: trino-sql
        source: trino-source
        description: "Lists all schemas in a specific catalog. If no catalog is provided, lists schemas in the current catalog."
        statement: |
            SHOW SCHEMAS
            FROM COALESCE(NULLIF($1, ''), CURRENT_CATALOG)
        parameters:
            - name: catalog_name
              type: string
              description: "Optional: Name of the catalog to list schemas from. If empty, uses the current catalog."

    list_tables:
        kind: trino-sql
        source: trino-source
        description: "Lists all tables in a specific schema. Optionally filter by table name pattern."
        statement: |
            SHOW TABLES
            FROM COALESCE(NULLIF($1, ''), CURRENT_SCHEMA)
            LIKE COALESCE(NULLIF($2, ''), '%')
        parameters:
            - name: schema_name
              type: string
              description: "Optional: Name of the schema to list tables from. If empty, uses the current schema."
            - name: table_pattern
              type: string
              description: "Optional: Pattern to filter table names (SQL LIKE pattern). If empty, shows all tables."

    describe_table:
        kind: trino-sql
        source: trino-source
        description: "Describes the structure of a table, showing columns, types, and other metadata."
        statement: DESCRIBE $1
        parameters:
            - name: table_name
              type: string
              description: "The name of the table to describe (can be fully qualified as catalog.schema.table)."
              required: true

    show_table_stats:
        kind: trino-sql
        source: trino-source
        description: "Shows statistics for a table including row count, data size, and column statistics."
        statement: SHOW STATS FOR $1
        parameters:
            - name: table_name
              type: string
              description: "The name of the table to show statistics for (can be fully qualified as catalog.schema.table)."
              required: true

    show_table_properties:
        kind: trino-sql
        source: trino-source
        description: "Shows table properties and configuration for a specific table."
        statement: SHOW CREATE TABLE $1
        parameters:
            - name: table_name
              type: string
              description: "The name of the table to show properties for (can be fully qualified as catalog.schema.table)."
              required: true

    list_functions:
        kind: trino-sql
        source: trino-source
        description: "Lists all available functions in the current catalog and schema, optionally filtered by pattern."
        statement: |
            SHOW FUNCTIONS
            LIKE COALESCE(NULLIF($1, ''), '%')
        parameters:
            - name: function_pattern
              type: string
              description: "Optional: Pattern to filter function names (SQL LIKE pattern). If empty, shows all functions."

    analyze_table:
        kind: trino-sql
        source: trino-source
        description: "Analyzes a table to compute statistics that can improve query performance."
        statement: ANALYZE TABLE $1
        parameters:
            - name: table_name
              type: string
              description: "The name of the table to analyze (can be fully qualified as catalog.schema.table)."
              required: true

toolsets:
    trino-database-tools:
        - execute_sql
        - list_catalogs
        - list_schemas
        - list_tables
        - describe_table
        - show_table_stats
        - show_table_properties
        - list_functions
        - analyze_table
